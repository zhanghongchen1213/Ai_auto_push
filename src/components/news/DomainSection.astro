---
import type { DomainSlug, DomainConfig } from '../../config/domains';
import type { NewsItem } from '../../lib/content-utils';
import NewsCard from './NewsCard.astro';

interface Props {
	domain: DomainConfig;
	items: readonly NewsItem[];
	date?: string;
}

const { domain, items, date } = Astro.props;
---

<section class="domain-section" aria-label={`${domain.name}领域资讯`} aria-hidden="false" data-domain={domain.slug}>
	<div class="section-header">
		<span class="color-bar" style={`background-color: ${domain.color};`}></span>
		<h2 class="section-title">
			<span class="domain-icon">{domain.icon}</span>
			{domain.name}
		</h2>
		<span class="item-count">{items.length} 条</span>
	</div>
	<div class="cards-list">
		{items.map((item, index) => (
			<NewsCard
				title={item.title}
				summary={item.summary}
				sourceUrl={item.sourceUrl}
				sourceName={item.sourceName}
				originalUrl={item.originalUrl}
				domain={domain.slug}
				anchorId={`news-${domain.slug}-${index + 1}`}
				date={date}
			/>
		))}
	</div>
</section>

<style>
	.domain-section {
		margin-bottom: 28px;
		transition: opacity 0.3s ease, max-height 0.5s ease, margin 0.3s ease;
		max-height: 9999px;
		opacity: 1;
	}
	.domain-section.domain-hidden {
		opacity: 0;
		max-height: 0;
		margin: 0;
		overflow: hidden;
		pointer-events: none;
	}
	.section-header {
		display: flex;
		align-items: center;
		gap: 10px;
		margin-bottom: 12px;
	}
	.color-bar {
		display: inline-block;
		width: 4px;
		height: 20px;
		border-radius: 2px;
		flex-shrink: 0;
	}
	.section-title {
		font-size: 16px;
		font-weight: 600;
		color: #1A1A1A;
		margin: 0;
		display: flex;
		align-items: center;
		gap: 6px;
	}
	.domain-icon {
		font-size: 16px;
	}
	.item-count {
		font-size: 12px;
		color: #8C8C8C;
		background: #F5F5F5;
		padding: 2px 8px;
		border-radius: 10px;
	}
	.cards-list {
		display: flex;
		flex-direction: column;
		gap: 12px;
	}

	/* Mobile: <768px */
	@media (max-width: 767px) {
		.domain-section {
			margin-bottom: 20px;
		}
		.section-header {
			gap: 8px;
			margin-bottom: 10px;
		}
		.section-title {
			font-size: 15px;
		}
		.cards-list {
			gap: 10px;
		}
	}
</style>
